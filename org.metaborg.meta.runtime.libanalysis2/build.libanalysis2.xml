<?xml version="1.0" encoding="UTF-8"?>
<project name="build.libanalysis2">

    <target name="libanalysis2-all" depends="libanalysis2-sdf2parenthesize"/>

    <target name="libanalysis2-pack-sdf" depends="copy-sdf2">
        <condition else="" property="utils-include" value="-I ${utils}">
                <available file="${utils}"/>
        </condition>
        <pack-sdf input="${syntax.rel}/libanalysis2/Analysis.sdf" output="${include.rel}/libanalysis2.def">
            <sdf-deps>
                <srcfiles dir="${basedir}" includes="**/*.sdf"/>
                <srcfiles dir="${lib}" includes="**/*.def"/>
                <srcfiles dir="${include}" includes="libanalysis2.def"/> 
            </sdf-deps>
        
            <args>
                <arg value="-I"/>
                <arg value="${syntax}"/>
                <arg value="-I"/>
                <arg value="${lib}"/>
                <arg line="${utils-include}"/>
                <arg line="${build.sdf.imports}"/>
            </args>
        </pack-sdf>
    </target>

    <target name="libanalysis2-sdf2parenthesize" depends="libanalysis2-pack-sdf,copy-sdf">
       <trycatch>
           <try>
                <sdf2parenthesize input="${include.rel}/libanalysis2.def"
                                  language="libanalysis2" main="libanalysis2/Analysis"
                                  output="${include.rel}/libanalysis2-parenthesize.str"
                                  outputmodule="include/libanalysis2-parenthesize">
                <args>
                    <arg value="--main-strategy"/>
                    <arg value="io-libanalysis2-parenthesize"/>
                    <arg value="--rule-prefix"/>
                    <arg value="libanalysis2"/>
                    <arg value="--sig-module"/>
                    <arg value="${lib-gen.rel}/libanalysis2"/>
                </args>
                </sdf2parenthesize>
            </try>
            <catch>
                <echo file="${include}/libanalysis2-parenthesize.str" message="module include/libanalysis2-parenthesize rules parenthesize-libanalysis2 = id" />
            </catch>
        </trycatch>
    </target>

</project>
